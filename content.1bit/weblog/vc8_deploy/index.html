

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
  <head>
<meta charset="utf-8">

<META NAME="author" CONTENT="Rodrigo Strauss">
<META NAME="ROBOTS" CONTENT="ALL">
    <title>Distribuindo aplicações feitas com o Visual C++ 8  ::::  Rodrigo Strauss :: www.1bit.com.br</title>
    <link href="../../../1bit.css" type="text/css" rel="stylesheet">
    <link rel="alternate" type="text/xml" title="RSS" href="../../../weblog_rss.1bit">
</head>
  <body style="margin:0px 0px 0px 0px" bgcolor="#FFFFFF">
    <table cellspacing="0" cellpadding="0" width="100%" border="0">
        <tr>
          <td class="header" valign="middle" bgcolor="#ffffff" height="77" colspan="2">&nbsp;
<a href="../../../"><img src="../../../images/logo_novo_2.png" border="0" alt="logo" /></a>

          </td>
        </tr>
        <tr>
          <td class="topmenu"></td>
          <td class="topmenu" align="right" height="30">
		    <a class="top_menu_link" href="../../../content.1bit/contact">Contato</a> 
			<span class="menusep">|</span>
            
            <a class="top_menu_link" href="../../../content.1bit/about">Sobre...</a>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          </td>
        </tr>
        <tr>
          <td class="topmenu"></td>
          <td>
          <table style="MARGIN: 0px" cellspacing="0" cellpadding="0" width="100%" border="0">
            <tr>
              <td><img src="../../../images/rebarba1.png" alt="rebarba"></td>
              <td align="right"><img src="../../../images/rebarba2.png" alt="rebarba"></td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td class="menu" valign="top" width="175">

<div class="left_menu_section">
 <h2><a href="../../../#artigos" style="text-decoration:none;">Artigos</a></h2>
</div>

<div class="left_menu_section">
 <h2><a href="../../../content.1bit/weblog_archive" style="text-decoration:none;">Blog</a></h2>
</div>

<div class="left_menu_section">
 <h2><a href="../../../content.1bit/opensource" style="text-decoration:none;">Open Source</a></h2>
</div>

<!-- 
<div class="left_menu_section">
 <h2><a href="content.1bit/aulas" style="text-decoration:none;">Aulas online (ou não) </a></h2>
</div>
-->


<br>
<br>
<br>
<center>

<!--
<a href="http://whos.amung.us/show/xopqoakh"><img src="http://whos.amung.us/cwidget/xopqoakh/fffffff6915a.png" alt="page counter" width="81" height="29" border="0" /></a>
-->

</center>



<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
          </td>
          <td valign="top">
<div class="content">
<h4><a href="../../../content.1bit/weblog_archive" style="text-decoration:none;">Rodrigo Strauss :: Blog</a></h4>
<table border="0">
<tr>
<!-- 
<td width="60">

<a style="text-decoration:none;" href="../../weblog_rss.1bit"><img src="../../../images/xml.gif" border="0"/></a>
</td>
-->

<td>



</td>

<td>




</td>

<td align="right">




<!--

<script type="text/javascript">
google_ad_client = "pub-2589539519655496";
google_ad_width = 468;
google_ad_height = 15;
google_ad_format = "468x15_0ads_al";
google_ad_channel = "";
google_color_border = "FFFFFF";
google_color_bg = "FFFFFF";
google_color_link = "FF5000";
google_color_text = "000000";
google_color_url = "FF5000";
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
-->






</td>
</tr>
</table>
<br>
<h5>Distribuindo aplicações feitas com o Visual C++ 8</h5><p>O Visual C++ 8 (que faz parte do Visual Studio 2005) trás além de diversas melhorias, mudanças na distribuição dos softwares compilados com ele. Algumas coisas importantes devem ser notadas, como o fato de que <b><a href="http://msdn2.microsoft.com/en-us/library/ms235285.aspx">distribuir aplicações em versão DEBUG é uma violação de EULA</a></b>.</p>

<p>O Visual C++ é atualmente a única ferramenta da Microsoft que possibilita que você compile um programa que não depende de runtimes ou DLLs adicionais, um programa que é 100% Windows e só. Mesmo assim, para fins de redução de tamanho dos arquivos binários e para facilitar a distribuição, muitos programadores preferem fazer link do aplicativo com a msvcr80.dll, mfc80.dll e atl80.dll. Nesse quesito, a grande mudança no Visual C++ 8 é que as runtimes da MFC e ATL devem ser distribuídas usando MSI ou <b>mantidas na pasta do aplicativo</b> (o que é uma recomendação antiga da Microsoft para diminuir do DLL Hell). O MSI (ou merge module se você fizer seu próprio setup) instalará as runtimes usando o recurso <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sbscs/setup/shared_assemblies.asp">Shared Assemblies</a> do Windows XP ou superior, para evitar que atualizações da runtime quebrem programas que estejam funcionando.</p>

<p><i>(Só não esqueça que o Shared Assemblies é um recurso do Windows e não do .NET. <b>As runtimes do Visual C++ 8 não têm qualquer dependência do .NET Framework e seus programas C++ serão nativos como sempre foram</b>. C++ == nativo/unmanaged, C++/CLI == .NET/managed.)</i></p>

<p>Apesar dos novos complicadores, existe uma <a href="http://msdn2.microsoft.com/en-us/library/zebw5zk9(en-US,VS.80).aspx">documentação bem explicada e detalhada na MSDN</a>, com destaque para o <a href="http://msdn2.microsoft.com/en-us/library/ms235291.aspx">How to deploy using XCOPY</a> e <a href="http://msdn2.microsoft.com/en-us/library/ms235624.aspx">Visual C++ Libraries as Shared Side-by-Side Assemblies</a>, que lista as DLLs necessárias e suas respectivas funções. </p>

<p>Se mesmo assim a coisa complicar, configure o seu projeto para fazer link estático com todas as bibliotecas (C++ runtime, MFC ou ATL) e você terá o velho e bom executável sem dependências e que roda em qualquer máquina com Windows instalado. :-)</p>

<br><p class="datetime">Em 22/02/2006 20:41, por  Rodrigo Strauss </p>
</div>
          </td>
        </tr>



<tr>
<td class="topmenu"></td>
<td>
<br>
<center>

<script type="text/javascript"><!--
google_ad_client = "pub-2589539519655496";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_type = "text";
google_ad_channel = "";
google_color_border = "FFFFFF";
google_color_bg = "FFFFFF";
google_color_link = "FF5000";
google_color_text = "000000";
google_color_url = "FF5000";
google_ui_features = "rc:6";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

</center>
</td>
</tr>

<tr>
 <td class="topmenu"></td>
 <td>
  <table style="margin: 0px" cellspacing="0" cellpadding="0" width="100%" border="0">
   <tr>
    <td><img src="../../../images/rebarba3.png"></td>
    <td align="right"><img src="../../../images/rebarba4.png"></td>
   </tr>
  </table>
 </td>
</tr>

<tr><td class="topmenu">&nbsp;</td><td class="topmenu">&nbsp;</td></tr>
<tr><td class="topmenu">&nbsp;</td><td>
<table style="MARGIN: 0px" cellspacing="0" cellpadding="0" width="100%" border="0">
            <tr>
              <td><img src="../../../images/rebarba1.png"></td>
              <td align="right"><img src="../../../images/rebarba2.png"></td>
              </tr>
            </table>
</td>
</tr>
 <tr><td class="topmenu">&nbsp;</td>
<td>

<div class="content">
<a name="comments"></a><h5>Comentários</h5><div class="post_comment">
<a name="954"></a><B>Hugo Parente Lima</B>  | em 27/02/2006 | <a rel="nofollow" href="../#954">#</a><br>
É uma decisão dificil... escolher entre facilidade (linkar tudo estaticamente) ou fazer seu executavel comer menos memoria... (linkar tudo dinamicamente e rodando com as dll's que tiverem em windows\system\etc...)
</div>
<div class="post_comment">
<a name="1176"></a><B>Luiz Alves</B>  | em 28/04/2006 | <a rel="nofollow" href="../#1176">#</a><br>
Estou interessado em avaliar o VC++8 para codificação de sistema de tempo real. A questão de "comer menos memória" me é interessante. Você experimentou este tipo de sistema com este software? Qual uma boa bibliografia para o produto além do help?
</div>
<div class="post_comment_strauss">
<a name="1178"></a><B>Rodrigo Strauss</B>  | <a rel="nofollow" href="http://www.1bit.com.br">website</a> | em 28/04/2006 | <a rel="nofollow" href="../#1178">#</a><br>
Em C++ você só paga por aquilo que você usa. Como você aloca e desaloca sua própria memória, você pode gerenciá-la como quiser.<br><br>Você pode ler qualquer livro de C++, não precisa ser específico de Visual C++
</div>
<div class="post_comment">
<a name="1197"></a><B>Lucas</B>  | em 30/04/2006 | <a rel="nofollow" href="../#1197">#</a><br>
bom eu sei qui aqui nao eh u lugar correto pra mim pedi isso e tal mas vejo aqui como meu ultimo recusro... ja que taum falandu em dll eu preciso de ajudaa... eu fui instalar um jogo e qnd eu vou instalar da o seguinte erro:<br><br>Executable 'E:\setup\rsrc\cod2.EXE' had the following error: Couldn't find library MSVCR80.dll (required by C:/ARQUIV~1\WINDOW~4\MpShHook.dll)<br>Please ensure that it is installed<br><br>eu sei que esta totalmente fora do contexto do qui é para comentar peço mil desculpas, mas se puder me ajudar brigadao!<br>e novamente desculpas por nao se tratar do assuntu tratado ae em cima. Desculpa mesmo!<br><br>Abração!
</div>
<div class="post_comment_strauss">
<a name="1204"></a><B>Rodrigo Strauss</B>  | <a rel="nofollow" href="http://www.1bit.com.br">website</a> | em 01/05/2006 | <a rel="nofollow" href="../#1204">#</a><br>
Baixe e instale a runtime do Visual C++ 8 em<br><br> <a rel="nofollow" href="http://www.microsoft.com/downloads/details.aspx?familyid=32BC1BEE-A3F9-4C13-9C99-220B62A191EE&displaylang=en">http://www.microsoft.com/downloads/details.aspx?familyid=32B...</a>
</div>
<div class="post_comment">
<a name="1484"></a><B>viinicius</B>  | em 21/09/2006 | <a rel="nofollow" href="../#1484">#</a><br>
Como que eu faço para criar um projeto linkado staticamente com as bibliotecas MFC e ATL? Para evitar o erro de falta da msvcr80.dll<br><br>Abraços<br>Vinicius
</div>
<div class="post_comment_strauss">
<a name="1485"></a><B>Rodrigo Strauss</B>  | <a rel="nofollow" href="http://www.1bit.com.br">website</a> | em 21/09/2006 | <a rel="nofollow" href="../#1485">#</a><br>
Propriedades do projeto, C/C++, Code Generation, Runtime Library. Mude para a versão estática.
</div>
<div class="post_comment">
<a name="1486"></a><B>vinicius</B>  | em 21/09/2006 | <a rel="nofollow" href="../#1486">#</a><br>
Obrigado cara,<br><br>Mas ainda tenho um problema. Estou colocando o IMSL para funcionar com o visual studio e compilo e crio o executavel sem problemas.<br><br>Quando vou executar fala que falta a msvcr80.dll, mesmo colocando no Runtime Library a opcao Multi-threaded.<br><br>O que eu posso fazer para resolver isso?<br><br>Abraços
</div>
<div class="post_comment_strauss">
<a name="1488"></a><B>Rodrigo Strauss</B>  | <a rel="nofollow" href="http://www.1bit.com.br">website</a> | em 22/09/2006 | <a rel="nofollow" href="../#1488">#</a><br>
O que é IMSL?
</div>
<div class="post_comment">
<a name="1489"></a><B>vinicius</B>  | em 22/09/2006 | <a rel="nofollow" href="../#1489">#</a><br>
Cara, <br><br>IMSL são um conjunto de funcoes matematicas, mas o problema não está nisso, acredito eu. Pois compila e dá o build bonito.<br><br>Acontece que na hora de executar fala que falta a dll que coloquei no post anterior.<br><br>Tem alguma idéia?<br><br>Abraços<br>Vinicius
</div>
<div class="post_comment_strauss">
<a name="1490"></a><B>Rodrigo Strauss</B>  | <a rel="nofollow" href="http://www.1bit.com.br">website</a> | em 22/09/2006 | <a rel="nofollow" href="../#1490">#</a><br>
As configurações para MFC e ATL ficam na parte "General" das propriedades do projeto. Veja "Use of MFC" e "Use of ATL".
</div>



</div>

</td></tr>



















<tr>
          <td class="topmenu"></td>
          <td>
          <table style="margin: 0px" cellspacing="0" cellpadding="0" width="100%" border="0">
            <tr>
              <td><img src="../../../images/rebarba3.png" alt="rebarba"></td>
              <td align="right"><img src="../../../images/rebarba4.png" alt="rebarba"></td>
            </tr>
          </table>
          </td>
        </tr>

        <tr>
          <td class="topmenu">&nbsp;</td>
          <td class="topmenu" height="25" align="right" style="color:#999999;">
::::
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          </td>
        </tr>
    </table>
  </body>
</html>
