

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
  <head>
<meta charset="utf-8">

<META NAME="author" CONTENT="Rodrigo Strauss">
<META NAME="ROBOTS" CONTENT="ALL">
    <title>A volta dos que foram mas voltaram logo  ::::  Rodrigo Strauss :: www.1bit.com.br</title>
    <link href="../../../1bit.css" type="text/css" rel="stylesheet">
    <link rel="alternate" type="text/xml" title="RSS" href="../../../weblog_rss.1bit">
</head>
  <body style="margin:0px 0px 0px 0px" bgcolor="#FFFFFF">
    <table cellspacing="0" cellpadding="0" width="100%" border="0">
        <tr>
          <td class="header" valign="middle" bgcolor="#ffffff" height="77" colspan="2">&nbsp;
<a href="../../../"><img src="../../../images/logo_novo_2.png" border="0" alt="logo" /></a>

          </td>
        </tr>
        <tr>
          <td class="topmenu"></td>
          <td class="topmenu" align="right" height="30">
		    <a class="top_menu_link" href="../../../content.1bit/contact">Contato</a> 
			<span class="menusep">|</span>
            
            <a class="top_menu_link" href="../../../content.1bit/about">Sobre...</a>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          </td>
        </tr>
        <tr>
          <td class="topmenu"></td>
          <td>
          <table style="MARGIN: 0px" cellspacing="0" cellpadding="0" width="100%" border="0">
            <tr>
              <td><img src="../../../images/rebarba1.png" alt="rebarba"></td>
              <td align="right"><img src="../../../images/rebarba2.png" alt="rebarba"></td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td class="menu" valign="top" width="175">

<div class="left_menu_section">
 <h2><a href="../../../#artigos" style="text-decoration:none;">Artigos</a></h2>
</div>

<div class="left_menu_section">
 <h2><a href="../../../content.1bit/weblog_archive" style="text-decoration:none;">Blog</a></h2>
</div>

<div class="left_menu_section">
 <h2><a href="../../../content.1bit/opensource" style="text-decoration:none;">Open Source</a></h2>
</div>

<!-- 
<div class="left_menu_section">
 <h2><a href="content.1bit/aulas" style="text-decoration:none;">Aulas online (ou não) </a></h2>
</div>
-->


<br>
<br>
<br>
<center>

<!--
<a href="http://whos.amung.us/show/xopqoakh"><img src="http://whos.amung.us/cwidget/xopqoakh/fffffff6915a.png" alt="page counter" width="81" height="29" border="0" /></a>
-->

</center>



<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
          </td>
          <td valign="top">
<div class="content">
<h4><a href="../../../content.1bit/weblog_archive" style="text-decoration:none;">Rodrigo Strauss :: Blog</a></h4>
<table border="0">
<tr>
<!-- 
<td width="60">

<a style="text-decoration:none;" href="../../weblog_rss.1bit"><img src="../../../images/xml.gif" border="0"/></a>
</td>
-->

<td>



</td>

<td>




</td>

<td align="right">




<!--

<script type="text/javascript">
google_ad_client = "pub-2589539519655496";
google_ad_width = 468;
google_ad_height = 15;
google_ad_format = "468x15_0ads_al";
google_ad_channel = "";
google_color_border = "FFFFFF";
google_color_bg = "FFFFFF";
google_color_link = "FF5000";
google_color_text = "000000";
google_color_url = "FF5000";
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
-->






</td>
</tr>
</table>
<br>
<h5>A volta dos que foram mas voltaram logo</h5><p>Algumas notícias importantes para movimentar meu quase abandonado site enquanto eu fico pensando em uma boa desculpa para essa situação:</p>

<ul>
<li>Voltei para São Paulo, e conseqüentemente, estou quase toda terça degustando um chopp no Bar Barão. Sim, isso é um convite. Para todos.
<li>O seminário da Tempo Real sobre Portabilidade e Performance foi muito bom, muito bom mesmo. Parabéns a todos nós do "C/C++ Brasil" por fazermos eventos com qualidade técnica tão alta, coisa que eu nunca vi nessas bandas. Fico feliz por poder compartilhar o que eu aprendi em incontáveis horas programando, dezenas de livros e outras dezenas de sites e artigos lidos. E fico muito mais feliz em poder aprender com pessoas que percorreram esse mesmo caminho, muitos que estudaram e leram muito mais do que eu. Eu sei que sou bom nesse negócio de programação (modéstia é um defeito que eu não tenho), mas minha vontade de aprender ainda é bem maior que meu ego. É **muito** bom conhecer e compartilhar conhecimento com gente que é melhor do que eu. Parabéns e obrigado a todos.
<li>Depois de mais de um mês offline (sim, essa é a desculpa), segue aqui a apresentação usada na minha palestra "Portabilidade via STL e Boost", onde eu fiz pelo STL e Boost o que os palestrantes da Microsoft/Sun/IBM/etc costumam fazer pelas empresas que pagam seus salários:
<br><br><br>
<iframe src='http://docs.google.com/EmbedSlideshow?docid=dg9kbfzn_51d6fbhkgc&amp;size=m' frameborder='0' width='555' height='451'></iframe>
<br>
</li>
</ul>

<p>Como um trecho de código vale mais do que uma apresentação cheia de piadinhas não-tão-engraçadas, segue o dito cujo que usei durante a demo da palestra:

<div class="code"><pre>
<span class="keyword">
#define</span> _CRT_SECURE_NO_WARNINGS<span class="keyword">
#define</span> _SCL_SECURE_NO_WARNINGS
&nbsp;<span class="keyword">
#include</span> &lt;vector><span class="keyword">
#include</span> &lt;string><span class="keyword">

#include</span> &lt;sstream>
&nbsp;<span class="keyword">
#include</span> &lt;iostream>
&nbsp;
&nbsp;<span class="keyword">
#include</span> &lt;boost/thread.hpp&gt;<span class="keyword">
#include</span> &lt;boost/bind.hpp&gt;<span class="keyword">
#include</span> &lt;boost/asio.hpp&gt;<span class="keyword">
#include</span> &lt;boost/function.hpp&gt;<span class="keyword">
#include</span> &lt;boost/array.hpp&gt;<span class="keyword">
#include</span> &lt;boost/lexical_cast.hpp&gt;<span class="keyword">
#include</span> &lt;boost/shared_array.hpp&gt;<span class="keyword">
#include</span> &lt;boost/enable_shared_from_this.hpp&gt;<span class="keyword">
#include</span> &lt;boost/ptr_container/ptr_map.hpp><span class="keyword">
#include</span> &lt;boost/ptr_container/ptr_set.hpp><span class="keyword">
#include</span> &lt;boost/algorithm/string.hpp><span class="keyword">
#include</span> &lt;boost/algorithm/string/join.hpp><span class="keyword">
#include</span> &lt;boost/format.hpp><span class="keyword">
#include</span> &lt;boost/date_time/gregorian/gregorian.hpp>
&nbsp;<span class="keyword">
#include</span> &lt;boost/program_options.hpp>
&nbsp;<span class="keyword">
#include</span> &lt;boost/tuple/tuple.hpp>
&nbsp;<span class="keyword">
#include</span> &lt;boost/foreach.hpp>
&nbsp;<span class="keyword">
#include</span> <span class="literal">"boost/filesystem.hpp"</span><span class="keyword"> 
#include</span> &lt;iostream>          
&nbsp;
<span class="keyword">using</span> <span class="keyword">namespace</span> std;
<span class="keyword">using</span> boost::lexical_cast;
<span class="keyword">using</span> boost::format;
<span class="keyword">using</span> boost::shared_ptr;
&nbsp;
boost::mutex log_mutex;
&nbsp;
<span class="keyword">void</span> Log(<span class="keyword">int</span> level, <span class="keyword">const</span> string&amp; str)
{
	boost::mutex::scoped_lock l(log_mutex);
&nbsp;
	cout &lt;&lt; 
		boost::format(<span class="literal">"%d - %s"</span>) % level % str
		&lt;&lt; endl;
}
&nbsp;
&nbsp;
<span class="keyword">void</span> f(<span class="keyword">int</span> level, string s1, string s2)
{
	Log(level, s1 + string(<span class="literal">" "</span>) + s2);
}
&nbsp;
<span class="keyword">typedef</span> vector&lt;shared_ptr&lt;boost::thread> > UmVectorDeThreads;
&nbsp;
UmVectorDeThreads Test_Threads()
{<span class="keyword">
#<span class="keyword">if</span></span> 0
	boost::array&lt;boost::thread, 32> threads;
	threads.at(2) = boost::thread(boost::bind(&amp;f, <span class="literal">"Eu programa aos sábados."</span>, <span class="literal">"E daí"</span>));<span class="keyword">

#endif</span>
&nbsp;
	boost::array&lt; shared_ptr&lt;boost::thread>, 32> threads;
&nbsp;
	<span class="keyword">for</span>(<span class="keyword">unsigned</span> <span class="keyword">int</span> i = 0 ; i &lt; threads.size() ; i++)
	{
		threads[i] = shared_ptr&lt;boost::thread>(
			<span class="keyword">new</span> boost::thread(
			boost::bind(&amp;f, 2, <span class="literal">"Eu programo aos sabados."</span>, 
			lexical_cast&lt;string>(i))));
	}
&nbsp;
	<span class="comment">//
</span>	<span class="comment">// ai...
</span>	<span class="comment">//
</span>	<span class="keyword">for</span>(boost::array&lt; shared_ptr&lt;boost::thread>, 32>::iterator i 
		= threads.begin() ; i != threads.end() ; ++i)
	{
&nbsp;
	}
&nbsp;
	BOOST_FOREACH(shared_ptr&lt;boost::thread> t, threads)
	{
&nbsp;
	}
&nbsp;
	boost::thread t;
&nbsp;
&nbsp;
	UmVectorDeThreads threads2(threads.size());
&nbsp;
	std::copy(threads.begin(), threads.end(), threads2.begin());
&nbsp;
	<span class="keyword">return</span> threads2;
}
&nbsp;
<span class="keyword">void</span> VamosEsperarAsThreads(UmVectorDeThreads&amp; threads)
{
	BOOST_FOREACH(shared_ptr&lt;boost::thread> t, threads)
	{
		t->join();
	}
}
&nbsp;
<span class="keyword">void</span> Test_FileSystem()
{
	<span class="keyword">using</span> <span class="keyword">namespace</span> boost::filesystem;          
	path p(<span class="literal">"c:\\temp\\abobrinha"</span>);
&nbsp;
	<span class="keyword">for</span>(path::iterator i = p.begin() ; i != p.end() ; ++i)
		cout &lt;&lt; *i &lt;&lt; endl;
}
&nbsp;
&nbsp;
<span class="keyword">void</span> Test_STL()
{
	vector&lt;string> v;
	list&lt;string> l;
	map&lt;<span class="keyword">int</span>, string> m;
&nbsp;
	<span class="keyword">for</span>(<span class="keyword">int</span> a = 0 ; a &lt; 20 ; a++)
	{
		string nome = <span class="literal">"Nome "</span> + lexical_cast&lt;string>(a);
		v.push_back(nome);
		m[a] = nome;
	}
&nbsp;
	copy(v.begin(), v.end(), back_inserter(l));
&nbsp;

	BOOST_FOREACH(<span class="keyword">const</span> string&amp; nome, v)
		cout &lt;&lt; nome &lt;&lt; endl;
&nbsp;
	for_each(l.begin(), l.end(), boost::bind(&amp;Log, 1, _1));
}
&nbsp;
<span class="keyword">int</span> main()
{
	UmVectorDeThreads threads = Test_Threads();
&nbsp;
	Test_STL();
	Test_FileSystem();
&nbsp;
	for_each(threads.begin(), threads.end(), 
		boost::bind(&amp;boost::thread::join, _1));
&nbsp;
	<span class="comment">//
</span>	<span class="comment">// olha mamãe, sem desalocar memória
</span>	<span class="comment">//
</span>	<span class="keyword">return</span> 0;
}</pre></div><br><p class="datetime">Em 21/06/2008 21:42, por  Rodrigo Strauss </p>
</div>
          </td>
        </tr>



<tr>
<td class="topmenu"></td>
<td>
<br>
<center>

<script type="text/javascript"><!--
google_ad_client = "pub-2589539519655496";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_type = "text";
google_ad_channel = "";
google_color_border = "FFFFFF";
google_color_bg = "FFFFFF";
google_color_link = "FF5000";
google_color_text = "000000";
google_color_url = "FF5000";
google_ui_features = "rc:6";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

</center>
</td>
</tr>

<tr>
 <td class="topmenu"></td>
 <td>
  <table style="margin: 0px" cellspacing="0" cellpadding="0" width="100%" border="0">
   <tr>
    <td><img src="../../../images/rebarba3.png"></td>
    <td align="right"><img src="../../../images/rebarba4.png"></td>
   </tr>
  </table>
 </td>
</tr>

<tr><td class="topmenu">&nbsp;</td><td class="topmenu">&nbsp;</td></tr>
<tr><td class="topmenu">&nbsp;</td><td>
<table style="MARGIN: 0px" cellspacing="0" cellpadding="0" width="100%" border="0">
            <tr>
              <td><img src="../../../images/rebarba1.png"></td>
              <td align="right"><img src="../../../images/rebarba2.png"></td>
              </tr>
            </table>
</td>
</tr>
 <tr><td class="topmenu">&nbsp;</td>
<td>

<div class="content">
<a name="comments"></a><h5>Comentários</h5><div class="post_comment">
<a name="2309"></a><B>Guilherme Costa</B>  | em 23/06/2008 | <a rel="nofollow" href="../#2309">#</a><br>
Rodrigo,<br><br>Tive a mesma experiencia, mas no sentido contrario. Sai de Poa para SP, e voltei 8 meses depois!!<br><br>As experiencias sao boas, mas algumas vezes nao sao bem o que precisamos no momento.<br><br>E se pra ti é melhor estar em SP, e continuar nos alimentando de informacoes uteis! Seja bem vindo de volta!!<br><br><br>Grande abraco,<br>Guilherme Costa
</div>
<div class="post_comment">
<a name="2319"></a><B>Denis</B>  | em 11/07/2008 | <a rel="nofollow" href="../#2319">#</a><br>
Estou com os seguintes erros ao compilar seu exemplo:<br>C:\PROGRAM FILES\BOOST\BOOST_1_35_0\boost/thread/win32/basic_timed_mutex.hpp(69) : error C2668: 'timed_lock' : ambiguous call to overloaded function<br>C:\PROGRAM FILES\BOOST\BOOST_1_35_0\boost/thread/locks.hpp(22) : error C2059: syntax error : '}'<br>C:\PROGRAM FILES\BOOST\BOOST_1_35_0\boost/thread/locks.hpp(22) : error C2143: syntax error : missing ';' before '}'<br>C:\PROGRAM FILES\BOOST\BOOST_1_35_0\boost/thread/locks.hpp(23) : error C2146: syntax error : missing ';' before identifier 'try_to_lock'<br>C:\PROGRAM FILES\BOOST\BOOST_1_35_0\boost/thread/locks.hpp(23) : error C2734: 'try_to_lock_t' : const object must be initialized if not extern<br>C:\PROGRAM FILES\BOOST\BOOST_1_35_0\boost/thread/locks.hpp(23) : fatal error C1004: unexpected end of file found<br><br>Se puder ajudar agradeço.<br>Obrigado
</div>
<div class="post_comment_strauss">
<a name="2320"></a><B>Rodrigo Strauss</B>  | <a rel="nofollow" href="http://www.1bit.com.br">website</a> | em 14/07/2008 | <a rel="nofollow" href="../#2320">#</a><br>
O fonte estava com problemas, tente novamente com essa atualização.
</div>
<div class="post_comment">
<a name="2321"></a><B>Denis</B>  | em 16/07/2008 | <a rel="nofollow" href="../#2321">#</a><br>
Continuo com o mesmo erro, estou usando o Boost no Visual C++ 6, será q é isso, instalei de novo para ver se tinha algum erro. Usei a instalação completa.<br>A linha do erro no boost é essa em basic_timed_mutex.hpp:<br>void lock()<br>{<br>BOOST_VERIFY(timed_lock(::boost::detail::get_system_time_sentinel()));<br>}<br><br>e essas aqui em lock.hpp:<br>const defer_lock_t defer_lock={};<br>const try_to_lock_t try_to_lock={};<br>const adopt_lock_t adopt_lock={};<br><br>Outra coisa, estou logado como usuario normal no Windows.<br><br>obrigado
</div>
<div class="post_comment_strauss">
<a name="2322"></a><B>Rodrigo Strauss</B>  | <a rel="nofollow" href="http://www.1bit.com.br">website</a> | em 16/07/2008 | <a rel="nofollow" href="../#2322">#</a><br>
O Boost 1.35 não funciona com o Visual C++ 6.0. Apesar de eles dizerem que as versões anteriores funcionam, eu não tive boas experiências com isso. Tente usar o Visual C++ Express.
</div>
<div class="post_comment">
<a name="2323"></a><B>Denis</B>  | em 16/07/2008 | <a rel="nofollow" href="../#2323">#</a><br>
Realmente algumas coisas até funcionam no VC6, como regex, tuple, asio etc. Testei seu exemplo no gcc e compilou corretamente. Muito bom seu exemplo, otimo para testar threads. Estava usando para sincronizar threads.<br>obrigado
</div>
<div class="post_comment">
<a name="2354"></a><B>Alexandre Tarifa</B>  | <a rel="nofollow" href="http://www.codificandomagazine.net">website</a> | em 27/08/2008 | <a rel="nofollow" href="../#2354">#</a><br>
Rodrigão, faz tempo que não acontece o chopp eim! vamos marcar.<br><br>[]'s<br><br>
</div>



</div>

</td></tr>



















<tr>
          <td class="topmenu"></td>
          <td>
          <table style="margin: 0px" cellspacing="0" cellpadding="0" width="100%" border="0">
            <tr>
              <td><img src="../../../images/rebarba3.png" alt="rebarba"></td>
              <td align="right"><img src="../../../images/rebarba4.png" alt="rebarba"></td>
            </tr>
          </table>
          </td>
        </tr>

        <tr>
          <td class="topmenu">&nbsp;</td>
          <td class="topmenu" height="25" align="right" style="color:#999999;">
::::
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          </td>
        </tr>
    </table>
  </body>
</html>
