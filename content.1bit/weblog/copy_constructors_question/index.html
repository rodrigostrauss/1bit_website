

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
  <head>
<meta charset="utf-8">

<META NAME="author" CONTENT="Rodrigo Strauss">
<META NAME="ROBOTS" CONTENT="ALL">
    <title>Mais explicações sobre copy constructors  ::::  Rodrigo Strauss :: www.1bit.com.br</title>
    <link href="../../../1bit.css" type="text/css" rel="stylesheet">
    <link rel="alternate" type="text/xml" title="RSS" href="../../../weblog_rss.1bit">
</head>
  <body style="margin:0px 0px 0px 0px" bgcolor="#FFFFFF">
    <table cellspacing="0" cellpadding="0" width="100%" border="0">
        <tr>
          <td class="header" valign="middle" bgcolor="#ffffff" height="77" colspan="2">&nbsp;
<a href="../../../"><img src="../../../images/logo_novo_2.png" border="0" alt="logo" /></a>

          </td>
        </tr>
        <tr>
          <td class="topmenu"></td>
          <td class="topmenu" align="right" height="30">
		    <a class="top_menu_link" href="../../../content.1bit/contact">Contato</a> 
			<span class="menusep">|</span>
            
            <a class="top_menu_link" href="../../../content.1bit/about">Sobre...</a>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          </td>
        </tr>
        <tr>
          <td class="topmenu"></td>
          <td>
          <table style="MARGIN: 0px" cellspacing="0" cellpadding="0" width="100%" border="0">
            <tr>
              <td><img src="../../../images/rebarba1.png" alt="rebarba"></td>
              <td align="right"><img src="../../../images/rebarba2.png" alt="rebarba"></td>
              </tr>
            </table>
          </td>
        </tr>
        <tr>
          <td class="menu" valign="top" width="175">

<div class="left_menu_section">
 <h2><a href="../../../#artigos" style="text-decoration:none;">Artigos</a></h2>
</div>

<div class="left_menu_section">
 <h2><a href="../../../content.1bit/weblog_archive" style="text-decoration:none;">Blog</a></h2>
</div>

<div class="left_menu_section">
 <h2><a href="../../../content.1bit/opensource" style="text-decoration:none;">Open Source</a></h2>
</div>

<!-- 
<div class="left_menu_section">
 <h2><a href="content.1bit/aulas" style="text-decoration:none;">Aulas online (ou não) </a></h2>
</div>
-->


<br>
<br>
<br>
<center>

<!--
<a href="http://whos.amung.us/show/xopqoakh"><img src="http://whos.amung.us/cwidget/xopqoakh/fffffff6915a.png" alt="page counter" width="81" height="29" border="0" /></a>
-->

</center>



<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
          </td>
          <td valign="top">
<div class="content">
<h4><a href="../../../content.1bit/weblog_archive" style="text-decoration:none;">Rodrigo Strauss :: Blog</a></h4>
<table border="0">
<tr>
<!-- 
<td width="60">

<a style="text-decoration:none;" href="../../weblog_rss.1bit"><img src="../../../images/xml.gif" border="0"/></a>
</td>
-->

<td>



</td>

<td>




</td>

<td align="right">




<!--

<script type="text/javascript">
google_ad_client = "pub-2589539519655496";
google_ad_width = 468;
google_ad_height = 15;
google_ad_format = "468x15_0ads_al";
google_ad_channel = "";
google_color_border = "FFFFFF";
google_color_bg = "FFFFFF";
google_color_link = "FF5000";
google_color_text = "000000";
google_color_url = "FF5000";
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
-->






</td>
</tr>
</table>
<br>
<h5>Mais explicações sobre copy constructors</h5><p>Aquele <a href="../../../content.1bit/weblog/smart_ptr_2_bug_expl">post sobre copy constructors</a> gerou para mim uma dúvida existencial: por que o compilador os gera automaticamente? Não é lá muito comum que os compiladores C++ gerem código.
</p>
<p>Depois procurar no <a href="http://www.research.att.com/~bs/bs_faq2.html">FAQ do Stroustrup</a> e não encontrar, resolvi perguntar aos gurus do 
<a href="http://groups-beta.google.com/group/comp.lang.c++.moderated">comp.lang.c++.moderated</a>. Se eles não soubessem, nem o próprio Stroustrup saberia, e eu continuaria até o fim dos meus dias com o peso da dúvida sobre os ombros. As <a href="http://groups-beta.google.com/group/comp.lang.c++.moderated/browse_thread/thread/86a5266447c9b4bf/b2809ec8cc77d1c2">respostas foram muito interessantes</a>.<br><p class="datetime">Em 11/04/2005 21:35, por  Rodrigo Strauss </p>
</div>
          </td>
        </tr>



<tr>
<td class="topmenu"></td>
<td>
<br>
<center>

<script type="text/javascript"><!--
google_ad_client = "pub-2589539519655496";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_type = "text";
google_ad_channel = "";
google_color_border = "FFFFFF";
google_color_bg = "FFFFFF";
google_color_link = "FF5000";
google_color_text = "000000";
google_color_url = "FF5000";
google_ui_features = "rc:6";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

</center>
</td>
</tr>

<tr>
 <td class="topmenu"></td>
 <td>
  <table style="margin: 0px" cellspacing="0" cellpadding="0" width="100%" border="0">
   <tr>
    <td><img src="../../../images/rebarba3.png"></td>
    <td align="right"><img src="../../../images/rebarba4.png"></td>
   </tr>
  </table>
 </td>
</tr>

<tr><td class="topmenu">&nbsp;</td><td class="topmenu">&nbsp;</td></tr>
<tr><td class="topmenu">&nbsp;</td><td>
<table style="MARGIN: 0px" cellspacing="0" cellpadding="0" width="100%" border="0">
            <tr>
              <td><img src="../../../images/rebarba1.png"></td>
              <td align="right"><img src="../../../images/rebarba2.png"></td>
              </tr>
            </table>
</td>
</tr>
 <tr><td class="topmenu">&nbsp;</td>
<td>

<div class="content">
<a name="comments"></a><h5>Comentários</h5><div class="post_comment">
<a name="221"></a><B>Thiago Adams</B>  | <a rel="nofollow" href="http://planeta.terra.com.br/informatica/thiago_adams/">website</a> | em 12/04/2005 | <a rel="nofollow" href="../#221">#</a><br>
O livro The Design and Evolution of C++, do Stroustrup tem todas as dúvidas filosóficas do C++.<br>Infelizmente nunca li este livro, mas já vi referência para ele em vários lugares sempre quando se tem uma dúvida do tipo "porque c++ é assim".<br><br>O copy contructor é uma solução para compatibilidade com o C. Acho que ele se enquadra bem no C++ e faz todo sentido.<br><br>Li algumas respostas do comp.lang.c++.moderated.<br>Interessante que lá tinha um exemplo de algo que eu faço, que é inicialização de variáveis assim:<br><br>int i(0);<br>double d(0.0);<br>double d = double();<br><br>Para templates é útil também pois você pode não saber o valor default do tipo. Daí basta colocar TIPO();<br>template&lt;class T&gt;<br>class X {<br> T value;<br> X () : value(T()) {}<br>}<br><br>Este conceito falha no caso de enums, para compatibilidade com o C.<br><br>enum E { a = 1, b = 2 };<br>E e = E();<br>não fica como 1 e sim com 0.<br>
</div>
<div class="post_comment_strauss">
<a name="222"></a><B>Rodrigo Strauss</B>  | <a rel="nofollow" href="http://www.1bit.com.br">website</a> | em 12/04/2005 | <a rel="nofollow" href="../#222">#</a><br>
Eu acho que ele faz todo sentido, mas queria saber porque ele é gerado automaticamente, já que isso pode causar bugs e não é algo comum em C++. <br><br>Alguém lá da comp.c++ disse que era para ficar mais parecido com os tipos básicos, mas alguém lá mesmo retrucou dizendo "se é assim, onde está meu operator+(X&) automático?" :-)
</div>
<div class="post_comment">
<a name="224"></a><B>Thiago</B>  | em 14/04/2005 | <a rel="nofollow" href="../#224">#</a><br>
Este bug aconteceu comigo na prática.<br>Achei que estava chamando um construtor..e na verdade estava chamando o construtor default.<br><br>struct A {};<br>class Utils<br>{<br>  // Utils(const Utils &) ;  //&lt;-- p/ confirmar<br>  A &m_a;<br>public:<br>  Utils(A &a) : m_a(a) {<br>    std::cout &lt;&lt;  "Hello!" &lt;&lt; std::endl;<br>  }<br>};<br><br>struct B : public A,<br>           public Utils<br>{<br>  //achei q estava chamando Utils(A &a)<br>  B() : Utils(*this) {} <br><br>  //B() : Utils((A&)*this) {} //&lt;- solucao<br>};<br><br>int main(int argc, char* argv[]) {<br>  B b;<br>}<br><br>*No caso real A era um CDialog, B era uma classe Derivada de um CDialog e Utils era um conjunto de funções utilitárias que precisavam de uma referencia para um CDialog.
</div>



</div>

</td></tr>



















<tr>
          <td class="topmenu"></td>
          <td>
          <table style="margin: 0px" cellspacing="0" cellpadding="0" width="100%" border="0">
            <tr>
              <td><img src="../../../images/rebarba3.png" alt="rebarba"></td>
              <td align="right"><img src="../../../images/rebarba4.png" alt="rebarba"></td>
            </tr>
          </table>
          </td>
        </tr>

        <tr>
          <td class="topmenu">&nbsp;</td>
          <td class="topmenu" height="25" align="right" style="color:#999999;">
::::
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          </td>
        </tr>
    </table>
  </body>
</html>
